@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@model ASPCore.Models.Film
@{
ViewData["Title"] = "Details";
}

<h2>@Model.Name</h2>
<p><strong>Author:</strong> @ViewBag.Author.Name @ViewBag.Author.Surname</p>
<p><strong>Author's Date of Birth:</strong> @ViewBag.Author.DateOfBirth</p>
<p><strong>Author's Description:</strong> @ViewBag.Author.Description</p>
<p><strong>Release Date:</strong> @Model.ReleaseDate</p>
<p><strong>Category:</strong> @Model.Category</p>
<p><strong>Star Rating:</strong> @Model.StarRating</p>

@if (User.Identity.IsAuthenticated)
{
	<a asp-action="AddComment" asp-controller="Home" asp-route-id="@Model.Id" class="btn btn-primary">Add Comment</a>
}
else
{
	<button class="btn btn-primary" disabled>Add Comment</button>
	<p>You must be logged in to add a comment.</p>
}

@if (Model.Comments != null && Model.Comments.Count > 0)
{
	<h3>Comments:</h3>
	foreach (var comment in Model.Comments)
	{
		<div>
			<p><strong>@comment.Username</strong> (@comment.UserEmail) said:</p>
			<p>@comment.Description</p>
			<p>Rating: @comment.StarRating</p>
			<p>Posted on: @comment.CreatedAt.ToString("g")</p>

			@if (User.Identity.IsAuthenticated && User.Identity.Name == comment.Username)
			{
				<a asp-action="DeleteComment" asp-controller="Home" asp-route-id="@comment.Id" class="btn btn-danger">Delete Comment</a>
			}
		</div>
	}
}
else
{
	<p>No comments yet.</p>
}